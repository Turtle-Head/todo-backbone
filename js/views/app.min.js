var app=app||{};app.AppView=Backbone.view.extend({el:"#todoapp",statsTemplate:_.template($("#stats-template").html()),events:{"keypress #new-todo":"createOnEnter","click #clear-completed":"clearCompleted","click #toggle-all":"toggleAllComplete"},initialize:function(){this.allCheckbox=this.$("#toggle-all")[0];this.$input=this.$("new-todo");this.$footer=this.$("#footer");this.$main=this.$("#main");this.listenTo(app.Todos,"add",this.addOne);this.listenTo(app.Todos,"reset",this.addAll);this.listenTo(app.Todos,"change:completed",this.filterOne);this.listenTo(app.Todos,"filter",this.filterAll);this.listenTo(app.Todos,"all",this.render);app.Todos.fetch()},render:function(){var b=app.Todos.completed().length;var a=app.Todos.remaining().length;if(app.Todos.length){this.$main.show();this.$footer.show();this.$footer.html(this.statsTemplate({completed:b,remaining:a}));this.$("#filters li a").removeClass("selected").filter('[href="#/'+(app.TodoFilter||"")+'"]').addClass("selected")}else{this.$main.hide();this.$footer.hide()}this.allCheckbox.checked=!a},addOne:function(a){var b=new app.TodoView({model:a});$("#todo-list").append(b.render().el)},addAll:function(){this.$("#todo-list").html("");app.Todos.each(this.addOne,this)},filterOne:function(a){a.trigger("visible")},filterAll:function(){app.Todos.each(this.filterOne,this)},newAttributes:function(){return{title:this.$input.val().trim(),order:app.Todos.nextOrder(),completed:false}},createOnEnter:function(a){if(a.which!==ENTER_KEY||!this.$input.val().trim()){return}app.Todos.create(this.newAttributes());this.$input.val("")},clearCompleted:function(){_invoke(app.Todos.completed(),"destroy");return false},toggleAllComplete:function(){var a=this.allCeckbox.checked;app.Todos.each(function(b){b.save({completed:a})})}});